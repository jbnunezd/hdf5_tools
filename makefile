#==================================================================================================#
# MAKEFILE
#==================================================================================================#
#
#
#--------------------------------------------------------------------------------------------------#
all: shared main
#--------------------------------------------------------------------------------------------------#
#
#--------------------------------------------------------------------------------------------------#
main:
	@printf "%`tput cols`s\n"|tr ' ' '-'
	@printf "COMPILING THE CODE...\n"
	@printf "%`tput cols`s\n"|tr ' ' '-'
	@cd src && touch deplist.mk && $(MAKE) -j -f makefile
	@printf "%`tput cols`s\n"|tr ' ' '-'
	@printf "COMPILING THE CODE... DONE!\n"
	@printf "%`tput cols`s\n"|tr ' ' '-'
#--------------------------------------------------------------------------------------------------#
#
#--------------------------------------------------------------------------------------------------#
shared:
	@printf "%`tput cols`s\n"|tr ' ' '-'
	@printf "COMPILING SHARED LIBRARIES...\n"
	@printf "%`tput cols`s\n"|tr ' ' '-'
	@cd ext && $(MAKE) -j -f makefile
	@printf "%`tput cols`s\n"|tr ' ' '-'
	@printf "COMPILING SHARED LIBRARIES... DONE!\n"
	@printf "%`tput cols`s\n"|tr ' ' '-'
#--------------------------------------------------------------------------------------------------#
#
#--------------------------------------------------------------------------------------------------#
run-serial:
	@./bin/main
#--------------------------------------------------------------------------------------------------#
#
#--------------------------------------------------------------------------------------------------#
run-parallel:
	@echo "`hostname` slots=8" > myhostfile
	@mpirun -np 8 --hostfile myhostfile ./bin/main
#--------------------------------------------------------------------------------------------------#
#
#--------------------------------------------------------------------------------------------------#
clean:
	@printf "%`tput cols`s"|tr ' ' '-'
	@printf "CLEANING UP THE PROJECT...\n"
	@printf "%`tput cols`s"|tr ' ' '-'
	@cd src && $(MAKE) clean
	@rm -f *~ */*~ */*/*~
	@printf "%`tput cols`s"|tr ' ' '-'
	@printf "CLEANING UP THE PROJECT... DONE!\n"
	@printf "%`tput cols`s"|tr ' ' '-'
#--------------------------------------------------------------------------------------------------#
#
#--------------------------------------------------------------------------------------------------#
veryclean:
	@printf "%`tput cols`s"|tr ' ' '-'
	@printf "CLEANING UP THE PROJECT...\n"
	@printf "%`tput cols`s"|tr ' ' '-'
	@cd src && $(MAKE) veryclean
	@rm -f *~ */*~ */*/*~
	@printf "%`tput cols`s"|tr ' ' '-'
	@printf "CLEANING UP THE PROJECT... DONE!\n"
	@printf "%`tput cols`s"|tr ' ' '-'
#--------------------------------------------------------------------------------------------------#
#
#--------------------------------------------------------------------------------------------------#
rebuild: veryclean all
#--------------------------------------------------------------------------------------------------#
#
#--------------------------------------------------------------------------------------------------#
# Utility Targets
#--------------------------------------------------------------------------------------------------#
.PHONY: all main rebuild run-serial run-parallel clean veryclean
#--------------------------------------------------------------------------------------------------#
